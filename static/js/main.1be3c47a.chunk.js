(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{25:function(e,n,t){},26:function(e,n,t){"use strict";t.r(n);var c,i=t(0),r=t(14),o=t.n(r),a=t(5),s=t(4),b=t(3),j=t(7),d=t(2),u="token",l=function(e){localStorage.setItem(u,e)},p=function(){return localStorage.getItem(u)},x="https://student-json-api.lidemy.me",O=function(e,n){return fetch("".concat(x,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:n})}).then((function(e){return e.json()}))},h=function(){var e=p();return fetch("".concat(x,"/me"),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},f=Object(i.createContext)(null),g=Object(i.createContext)(null),m=t(1),v=b.b.div(c||(c=Object(s.a)(["\n  color:red\n"])));function w(){var e=Object(i.useContext)(f).setUser,n=Object(i.useState)(""),t=Object(a.a)(n,2),c=t[0],r=t[1],o=Object(i.useState)(""),s=Object(a.a)(o,2),b=s[0],j=s[1],u=Object(i.useState)(),p=Object(a.a)(u,2),x=p[0],g=p[1],w=Object(d.f)();return Object(m.jsxs)("form",{onSubmit:function(n){g(null),O(c,b).then((function(n){if(0===n.ok)return g(n.message);l(n.token),h().then((function(n){if(1!==n.ok)return l(null),g(n.toString());e(n.data),w("/")}))}))},children:[Object(m.jsxs)("div",{children:["username: "," ",Object(m.jsx)("input",{value:c,onChange:function(e){r(e.target.value)}})]}),Object(m.jsxs)("div",{children:["password: "," ",Object(m.jsx)("input",{type:"password",value:b,onChange:function(e){return j(e.target.value)}})]}),Object(m.jsx)("button",{children:"\u767b\u5165"}),x&&Object(m.jsx)(v,{children:x})]})}t(13);var y,k,S,C,_,z,F,L,N,E=b.b.div(y||(y=Object(s.a)(["\n  text-align: center;\n"]))),P=b.b.button(k||(k=Object(s.a)(["\n  font-size: 8px;\n  border-radius: 5px;\n  padding: 12px;\n  background: transparent;\n  color: black;\n  border: 1px solid #00BFFF;\n  cursor: pointer;\n  &:active {\n    background: #00BFFF;\n  }\n  & + & {\n    margin-left: 10px;\n  }\n"]))),B=b.b.div(S||(S=Object(s.a)(["\n  padding-top: 36px;\n"])));function T(e){var n=e.page,t=e.handlePageClick;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(E,{children:[Object(m.jsx)(P,{onClick:function(){t("First")},children:"\u7b2c\u4e00\u9801"}),Object(m.jsx)(P,{onClick:function(){t("Prev")},children:"\u4e0a\u4e00\u9801"}),n,Object(m.jsx)(P,{onClick:function(){t("Next")},children:"\u4e0b\u4e00\u9801"}),Object(m.jsx)(P,{onClick:function(){t("Last")},children:"\u6700\u672b\u9801"})]}),Object(m.jsx)(B,{})]})}var D,J,$,A,I,U,M=b.b.div(C||(C=Object(s.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]))),q=b.b.div(_||(_=Object(s.a)(["\n  \n  padding: 20px 40px 30px 40px;\n  max-width: 800px;\n  margin: 30px auto;\n  font-size: 20px;\n  @media screen and (max-width: 768px) {\n    margin: 100px auto;\n    overflow: hidden;\n  }\n"]))),G=b.b.div(z||(z=Object(s.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n \n"]))),W=Object(b.b)(j.b)(F||(F=Object(s.a)(["\n  margin: 3px 20px;\n  font-size: 28px;\n  font-weight: 600;\n  color: #333;\n  text-decoration: none;\n"]))),Y=b.b.p(L||(L=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n  margin-left: 10px;\n  font-size: 16px;\n"]))),H=b.b.div(N||(N=Object(s.a)(["\n  width: 700px; \n  display: flex;\n  align-items: center;\n  margin: 3px 30px;\n  padding-left: 5px;\n"]))),K={paddingLeft:"10px"};function Q(e){var n=e.post;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(q,{children:[Object(m.jsx)(G,{children:Object(m.jsx)(W,{to:"/posts/".concat(n.id),children:n.title})}),Object(m.jsxs)(H,{children:[Object(m.jsx)("p",{children:"Posted by"})," ",Object(m.jsx)("p",{style:K,children:n.user.nickname}),Object(m.jsx)("p",{style:K,children:"on"}),Object(m.jsx)(Y,{children:new Date(n.createdAt).toLocaleString()})]})]})})}function R(){var e=Object(i.useState)([]),n=Object(a.a)(e,2),t=n[0],c=n[1],r=Object(i.useState)(),o=Object(a.a)(r,2),s=o[0],b=o[1],j=Object(i.useState)(1),d=Object(a.a)(j,2),u=d[0],l=d[1];fetch("".concat(x,"/posts?_expand=user&_sort=createdAt&_order=desc")).then((function(e){return e.json()})).then((function(e){var n=Number(e.length);b(Math.ceil(n/5))})),Object(i.useEffect)((function(){(function(e){return fetch("".concat(x,"/posts?_expand=user&_sort=createdAt&_order=desc&_page=").concat(e,"&_limit=5")).then((function(e){return e.json()}))})(u).then((function(e){c(e),console.log(e)})),window.scrollTo({top:0,behavior:"smooth"})}),[u]);return Object(m.jsxs)(M,{children:[t.map((function(e){return Object(m.jsx)(Q,{post:e},e.id)})),Object(m.jsx)(T,{page:u,handlePageClick:function(e){return"First"===e?l(1):"Prev"===e&&u>1?l(u-1):"Next"===e&&u<s?l(u+1):"Last"===e?l(s):void 0}})]})}var V,X,Z,ee,ne=b.b.div(D||(D=Object(s.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]))),te=b.b.div(J||(J=Object(s.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  \n"]))),ce=b.b.h1($||($=Object(s.a)([""]))),ie=b.b.div(A||(A=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]))),re=b.b.p(I||(I=Object(s.a)(["\n  white-space: pre-wrap;\n  \n"]))),oe=b.b.div(U||(U=Object(s.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n  font-size: 24px;\n  background: rgba(0, 0, 0, 0.3);\n"])));function ae(e){var n=e.post,t=e.onDelete;return n?Object(m.jsxs)(te,{children:[Object(m.jsx)(ce,{children:n.title}),Object(m.jsx)(ie,{children:new Date(n.createdAt).toLocaleString()}),Object(m.jsx)(re,{children:n.body}),Object(m.jsx)("button",{onClick:t,children:"\u522a\u9664"})]}):null}function se(){var e=Object(i.useState)(),n=Object(a.a)(e,2),t=n[0],c=n[1],r=Object(i.useState)(!1),o=Object(a.a)(r,2),s=o[0],b=o[1],j=Object(d.f)(),u=Object(d.g)().id;return Object(i.useEffect)((function(){b(!0),function(e){return fetch("".concat(x,"/posts/").concat(e,"?_expand=user")).then((function(e){return e.json()}))}(u).then((function(e){b(!1),c(e)})).catch((function(e){b(!1)}))}),[u]),Object(m.jsxs)(ne,{children:[Object(m.jsx)(ae,{post:t,onDelete:function(){(function(e){var n=p();return fetch("".concat(x,"/posts/").concat(e),{method:"DELETE",headers:{authorization:"Bearer ".concat(n),"content-type":"application/json"}}).then((function(e){return e.json()}))})(u).then((function(){j("/")}))}}),s&&Object(m.jsx)(oe,{children:"\u8f09\u5165\u4e2d"})]})}var be,je=b.b.form(V||(V=Object(s.a)(["\n  border: solid 3px black;\n  padding: 20px 40px 60px 40px;\n  max-width: 800px;\n  margin: 30px auto;\n  font-size: 20px;\n  @media screen and (max-width: 768px) {\n    margin: 100px auto;\n    overflow: hidden;\n  }\n"]))),de=b.b.input(X||(X=Object(s.a)(["\n  margin-bottom: 12px;\n  width: 100%;\n  font-size: 16px;\n  padding: 10px;\n"]))),ue=b.b.textarea(Z||(Z=Object(s.a)(["\n  width: 100%;\n  font-size: 16px;\n  padding: 12px;\n"]))),le=b.b.button(ee||(ee=Object(s.a)(["\n  padding: 12px;\n  background: #ff8100;\n  color: white;\n  border: solid 1px #ff8100;\n  cursor: pointer;\n  float: right;\n  &:hover {\n    background: #ff8100;\n  }\n  & + & {\n    margin-left: 5px;\n  }\n"])));function pe(){var e=Object(i.useState)(""),n=Object(a.a)(e,2),t=n[0],c=n[1],r=Object(i.useState)(""),o=Object(a.a)(r,2),s=o[0],b=o[1],j=Object(d.f)(),u=function(e){(function(e,n){var t=p();return fetch("".concat(x,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(t)},body:JSON.stringify({title:e,body:n})}).then((function(e){return e.json()}))})(t,s).then((function(e){console.log(e),e.id&&j("/")}))};return Object(m.jsxs)(je,{onSubmit:u,children:["Title:"," ",Object(m.jsx)(de,{value:t,onChange:function(e){return c(e.target.value)}}),"Content:"," ",Object(m.jsx)(ue,{rows:"20",value:s,onChange:function(e){return b(e.target.value)}}),Object(m.jsx)(le,{onClick:u,children:"submit"})]})}var xe=b.b.div(be||(be=Object(s.a)(["\n  color:red\n"])));function Oe(){var e=Object(i.useContext)(f).setUser,n=Object(i.useState)(""),t=Object(a.a)(n,2),c=t[0],r=t[1],o=Object(i.useState)(""),s=Object(a.a)(o,2),b=s[0],j=s[1],u=Object(i.useState)("Lidemy"),p=Object(a.a)(u,2),g=p[0],v=p[1],w=Object(i.useState)(),y=Object(a.a)(w,2),k=y[0],S=y[1],C=Object(d.f)();return Object(m.jsxs)("form",{onSubmit:function(n){S(null),function(e,n,t){return fetch("".concat(x,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:e,username:n,password:t})}).then((function(e){return e.json()}))}(c,b,g).then((function(n){if(console.log(n),0===n.ok)return S(n.message);O(b,g).then((function(n){if(0===n.ok)return S(n.message);l(n.token),h().then((function(n){if(1!==n.ok)return l(null),S(n.toString());e(n.data),C("/")}))}))}))},children:[Object(m.jsxs)("div",{children:["nickname: "," ",Object(m.jsx)("input",{value:c,onChange:function(e){return r(e.target.value)}})]}),Object(m.jsxs)("div",{children:["username: "," ",Object(m.jsx)("input",{value:b,onChange:function(e){return j(e.target.value)}})]}),Object(m.jsxs)("div",{children:["password: "," ",Object(m.jsx)("input",{type:"password",value:g,onChange:function(e){return v(e.target.value)}})]}),Object(m.jsx)("button",{children:"\u8a3b\u518a"}),k&&Object(m.jsx)(xe,{children:k})]})}t(25);var he,fe,ge,me,ve,we,ye,ke=b.b.div(he||(he=Object(s.a)([""]))),Se=b.b.div(fe||(fe=Object(s.a)(["\n  height: 80px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding:0px 32px;\n  box-sizing: border-box;\n  background:\t#F5F5F5;\n"]))),Ce=b.b.div(ge||(ge=Object(s.a)(["\nfont-style:oblique;\nfont-size: 10px;\nfont-weight: bold;\n\n"]))),_e=b.b.div(me||(me=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  height: 80px;\n"]))),ze=Object(b.b)(j.b)(ve||(ve=Object(s.a)([" \n  font-size: 20px;\n  font-weight: 600;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  "," \n"])),(function(e){return e.$active&&"\n    background: \t#B0C4DE;\n  "})),Fe=b.b.div(we||(we=Object(s.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"])),_e);function Le(){var e=Object(i.useContext)(g).isLoading,n=Object(d.e)(),t=Object(d.f)(),c=Object(i.useContext)(f),r=c.user,o=c.setUser;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(Se,{className:"navbar fixed-top navbar-light",children:[Object(m.jsxs)(Fe,{children:[Object(m.jsx)(Ce,{to:"/",children:"Blog"}),Object(m.jsxs)(_e,{className:"navbar-fixed-top",children:[Object(m.jsx)(ze,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),r&&Object(m.jsx)(ze,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),!e&&Object(m.jsxs)(_e,{className:"navbar-fixed-top",children:[!r&&Object(m.jsx)(ze,{to:"/register",$active:"/register"===n.pathname,children:"\u8a3b\u518a"}),!r&&Object(m.jsx)(ze,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),r&&Object(m.jsx)(ze,{to:"/login",onClick:function(){l(""),o(null),t("/")},children:"\u767b\u51fa"})]})]}),Object(m.jsx)(ke,{children:Object(m.jsx)("div",{className:"top-banner",children:Object(m.jsx)("div",{className:"top-banner__info",children:Object(m.jsx)("h1",{className:"top-banner__sub-title",children:"WELCOME TO MY BLOG"})})})})]})}var Ne=b.b.div(ye||(ye=Object(s.a)(["\n  padding-top: 64px;\n"])));var Ee=function(){var e=Object(i.useState)(null),n=Object(a.a)(e,2),t=n[0],c=n[1],r=Object(i.useState)(!0),o=Object(a.a)(r,2),s=o[0],b=o[1];return Object(i.useEffect)((function(){p()?h().then((function(e){b(!1),e.ok&&(c(e.data),b(!1))})):b(!1)}),[]),Object(m.jsx)(f.Provider,{value:{user:t,setUser:c},children:Object(m.jsx)(g.Provider,{value:{isLoading:s,setIsLoading:b},children:Object(m.jsx)(Ne,{children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(Le,{}),Object(m.jsxs)(d.c,{children:[Object(m.jsx)(d.a,{path:"/",element:Object(m.jsx)(R,{})}),Object(m.jsx)(d.a,{path:"/login",element:Object(m.jsx)(w,{})}),Object(m.jsx)(d.a,{path:"/register",element:Object(m.jsx)(Oe,{})}),Object(m.jsx)(d.a,{path:"/posts/:id",element:Object(m.jsx)(se,{})}),Object(m.jsx)(d.a,{path:"/new-post",element:Object(m.jsx)(pe,{})})]})]})})})})};o.a.render(Object(m.jsx)(b.a,{theme:{colors:{primary_300:"#3333dd",primary_400:"#e33e3e",primary_500:"#af0505"}},children:Object(m.jsx)(Ee,{})}),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.1be3c47a.chunk.js.map