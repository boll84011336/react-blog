(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var c,i,r=n(0),a=n(14),o=n.n(a),s=n(5),b=n(4),j=n(2),d=n(7),u=n(3),l="token",p=function(e){localStorage.setItem(l,e)},x=function(){return localStorage.getItem(l)},O="https://student-json-api.lidemy.me",h=function(e,t){return fetch("".concat(O,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))},f=function(){var e=x();return fetch("".concat(O,"/me"),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},g=Object(r.createContext)(null),m=Object(r.createContext)(null),v=n(1),w=(j.b.div(c||(c=Object(b.a)([""]))),j.b.div(i||(i=Object(b.a)(["\n  color:red\n"]))));function y(){var e=Object(r.useContext)(g).setUser,t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],i=n[1],a=Object(r.useState)(""),o=Object(s.a)(a,2),b=o[0],j=o[1],d=Object(r.useState)(),l=Object(s.a)(d,2),x=l[0],O=l[1],m=Object(u.f)();return Object(v.jsxs)("form",{onSubmit:function(t){O(null),h(c,b).then((function(t){if(0===t.ok)return O(t.message);p(t.token),f().then((function(t){if(1!==t.ok)return p(null),O(t.toString());e(t.data),m("/")}))}))},children:[Object(v.jsxs)("div",{children:["username: "," ",Object(v.jsx)("input",{value:c,onChange:function(e){i(e.target.value)}})]}),Object(v.jsxs)("div",{children:["password: "," ",Object(v.jsx)("input",{type:"password",value:b,onChange:function(e){return j(e.target.value)}})]}),Object(v.jsx)("button",{children:"\u767b\u5165"}),x&&Object(v.jsx)(w,{children:x})]})}n(13);var k,S,C,_,z,F,L,N,E,P,B=j.b.div(k||(k=Object(b.a)(["\n  text-align: center;\n"]))),T=j.b.button(S||(S=Object(b.a)(["\n  font-size: 8px;\n  border-radius: 5px;\n  padding: 12px;\n  background: transparent;\n  color: black;\n  border: 1px solid #00BFFF;\n  cursor: pointer;\n  &:active {\n    background: #00BFFF;\n  }\n  & + & {\n    margin-left: 10px;\n  }\n"]))),D=j.b.div(C||(C=Object(b.a)(["\n  padding-top: 36px;\n"])));j.b.p(_||(_=Object(b.a)(["\n  margin:0px 2px;\n"])));function J(e){var t=e.page,n=e.handlePageClick,c=Object(r.useState)([]),i=Object(s.a)(c,2);i[0],i[1];return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(B,{children:[Object(v.jsx)(T,{onClick:function(){n("First")},children:"\u7b2c\u4e00\u9801"}),Object(v.jsx)(T,{onClick:function(){n("Prev")},children:"\u4e0a\u4e00\u9801"}),t,Object(v.jsx)(T,{onClick:function(){n("Next")},children:"\u4e0b\u4e00\u9801"}),Object(v.jsx)(T,{onClick:function(){n("Last")},children:"\u6700\u672b\u9801"})]}),Object(v.jsx)(D,{})]})}var $,A,I,U,M,q,G=j.b.div(z||(z=Object(b.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]))),W=j.b.div(F||(F=Object(b.a)(["\n  \n  padding: 20px 40px 30px 40px;\n  max-width: 800px;\n  margin: 30px auto;\n  font-size: 20px;\n  @media screen and (max-width: 768px) {\n    margin: 100px auto;\n    overflow: hidden;\n  }\n"]))),Y=j.b.div(L||(L=Object(b.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n \n"]))),H=Object(j.b)(d.b)(N||(N=Object(b.a)(["\n  margin: 3px 20px;\n  font-size: 28px;\n  font-weight: 600;\n  color: #333;\n  text-decoration: none;\n"]))),K=j.b.p(E||(E=Object(b.a)(["\n  color: rgba(0, 0, 0, 0.8);\n  margin-left: 10px;\n  font-size: 16px;\n"]))),Q=j.b.div(P||(P=Object(b.a)(["\n  width: 700px; \n  display: flex;\n  align-items: center;\n  margin: 3px 30px;\n  padding-left: 5px;\n"]))),R={paddingLeft:"10px"};function V(e){var t=e.post;return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(W,{children:[Object(v.jsx)(Y,{children:Object(v.jsx)(H,{to:"/posts/".concat(t.id),children:t.title})}),Object(v.jsxs)(Q,{children:[Object(v.jsx)("p",{children:"Posted by"})," ",Object(v.jsx)("p",{style:R,children:t.user.nickname}),Object(v.jsx)("p",{style:R,children:"on"}),Object(v.jsx)(K,{children:new Date(t.createdAt).toLocaleString()})]})]})})}function X(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(),a=Object(s.a)(i,2),o=a[0],b=a[1],j=Object(r.useState)(1),d=Object(s.a)(j,2),u=d[0],l=d[1];fetch("".concat(O,"/posts?_expand=user&_sort=createdAt&_order=desc")).then((function(e){return e.json()})).then((function(e){var t=Number(e.length);b(Math.ceil(t/5))})),Object(r.useEffect)((function(){(function(e){return fetch("".concat(O,"/posts?_expand=user&_sort=createdAt&_order=desc&_page=").concat(e,"&_limit=5")).then((function(e){return e.json()}))})(u).then((function(e){c(e),console.log(e)})),window.scrollTo({top:0,behavior:"smooth"})}),[u]);return Object(v.jsxs)(G,{children:[n.map((function(e){return Object(v.jsx)(V,{post:e},e.id)})),Object(v.jsx)(J,{page:u,handlePageClick:function(e){return"First"===e?l(1):"Prev"===e&&u>1?l(u-1):"Next"===e&&u<o?l(u+1):"Last"===e?l(o):void 0}})]})}var Z,ee,te,ne,ce=j.b.div($||($=Object(b.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]))),ie=j.b.div(A||(A=Object(b.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  \n"]))),re=j.b.h1(I||(I=Object(b.a)([""]))),ae=j.b.div(U||(U=Object(b.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]))),oe=j.b.p(M||(M=Object(b.a)(["\n  white-space: pre-wrap;\n  \n"]))),se=j.b.div(q||(q=Object(b.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n  font-size: 24px;\n  background: rgba(0, 0, 0, 0.3);\n"])));function be(e){var t=e.post,n=e.onDelete;return t?Object(v.jsxs)(ie,{children:[Object(v.jsx)(re,{children:t.title}),Object(v.jsx)(ae,{children:new Date(t.createdAt).toLocaleString()}),Object(v.jsx)(oe,{children:t.body}),Object(v.jsx)("button",{onClick:n,children:"\u522a\u9664"})]}):null}function je(){var e=Object(r.useState)(),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(!1),a=Object(s.a)(i,2),o=a[0],b=a[1],j=Object(u.f)(),d=Object(u.g)().id;return Object(r.useEffect)((function(){b(!0),function(e){return fetch("".concat(O,"/posts/").concat(e,"?_expand=user")).then((function(e){return e.json()}))}(d).then((function(e){b(!1),c(e)})).catch((function(e){b(!1)}))}),[d]),Object(v.jsxs)(ce,{children:[Object(v.jsx)(be,{post:n,onDelete:function(){(function(e){var t=x();return fetch("".concat(O,"/posts/").concat(e),{method:"DELETE",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"}}).then((function(e){return e.json()}))})(d).then((function(){j("/")}))}}),o&&Object(v.jsx)(se,{children:"\u8f09\u5165\u4e2d"})]})}var de,ue,le=j.b.form(Z||(Z=Object(b.a)(["\n  border: solid 3px black;\n  padding: 20px 40px 60px 40px;\n  max-width: 800px;\n  margin: 30px auto;\n  font-size: 20px;\n  @media screen and (max-width: 768px) {\n    margin: 100px auto;\n    overflow: hidden;\n  }\n"]))),pe=j.b.input(ee||(ee=Object(b.a)(["\n  margin-bottom: 12px;\n  width: 100%;\n  font-size: 16px;\n  padding: 10px;\n"]))),xe=j.b.textarea(te||(te=Object(b.a)(["\n  width: 100%;\n  font-size: 16px;\n  padding: 12px;\n"]))),Oe=j.b.button(ne||(ne=Object(b.a)(["\n  padding: 12px;\n  background: #ff8100;\n  color: white;\n  border: solid 1px #ff8100;\n  cursor: pointer;\n  float: right;\n  &:hover {\n    background: #ff8100;\n  }\n  & + & {\n    margin-left: 5px;\n  }\n"])));function he(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(""),a=Object(s.a)(i,2),o=a[0],b=a[1],j=Object(u.f)(),d=function(e){(function(e,t){var n=x();return fetch("".concat(O,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:e,body:t})}).then((function(e){return e.json()}))})(n,o).then((function(e){console.log(e),e.id&&j("/")}))};return Object(v.jsxs)(le,{onSubmit:d,children:["Title:"," ",Object(v.jsx)(pe,{value:n,onChange:function(e){return c(e.target.value)}}),"Content:"," ",Object(v.jsx)(xe,{rows:"20",value:o,onChange:function(e){return b(e.target.value)}}),Object(v.jsx)(Oe,{onClick:d,children:"submit"})]})}j.b.div(de||(de=Object(b.a)([""])));var fe=j.b.div(ue||(ue=Object(b.a)(["\n  color:red\n"])));function ge(){var e=Object(r.useContext)(g).setUser,t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],i=n[1],a=Object(r.useState)(""),o=Object(s.a)(a,2),b=o[0],j=o[1],d=Object(r.useState)("Lidemy"),l=Object(s.a)(d,2),x=l[0],m=l[1],w=Object(r.useState)(),y=Object(s.a)(w,2),k=y[0],S=y[1],C=Object(u.f)();return Object(v.jsxs)("form",{onSubmit:function(t){S(null),function(e,t,n){return fetch("".concat(O,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:e,username:t,password:n})}).then((function(e){return e.json()}))}(c,b,x).then((function(t){if(console.log(t),0===t.ok)return S(t.message);h(b,x).then((function(t){if(0===t.ok)return S(t.message);p(t.token),f().then((function(t){if(1!==t.ok)return p(null),S(t.toString());e(t.data),C("/")}))}))}))},children:[Object(v.jsxs)("div",{children:["nickname: "," ",Object(v.jsx)("input",{value:c,onChange:function(e){return i(e.target.value)}})]}),Object(v.jsxs)("div",{children:["username: "," ",Object(v.jsx)("input",{value:b,onChange:function(e){return j(e.target.value)}})]}),Object(v.jsxs)("div",{children:["password: "," ",Object(v.jsx)("input",{type:"password",value:x,onChange:function(e){return m(e.target.value)}})]}),Object(v.jsx)("button",{children:"\u8a3b\u518a"}),k&&Object(v.jsx)(fe,{children:k})]})}n(25);var me,ve,we,ye,ke,Se,Ce,_e=j.b.div(me||(me=Object(b.a)([""]))),ze=j.b.div(ve||(ve=Object(b.a)(["\n  height: 80px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding:0px 32px;\n  box-sizing: border-box;\n  background:\t#F5F5F5;\n"]))),Fe=j.b.div(we||(we=Object(b.a)(["\nfont-style:oblique;\nfont-size:48px;\nfont-weight: bold;\n"]))),Le=j.b.div(ye||(ye=Object(b.a)(["\n  display: flex;\n  align-items: center;\n  height: 80px;\n"]))),Ne=Object(j.b)(d.b)(ke||(ke=Object(b.a)([" \n  font-size: 20px;\n  font-weight: 600;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  "," \n"])),(function(e){return e.$active&&"\n    background: \t#B0C4DE;\n  "})),Ee=j.b.div(Se||(Se=Object(b.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"])),Le);function Pe(){var e=Object(r.useContext)(m).isLoading,t=Object(u.e)(),n=Object(u.f)(),c=Object(r.useContext)(g),i=c.user,a=c.setUser;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(ze,{className:"navbar fixed-top navbar-light",children:[Object(v.jsxs)(Ee,{children:[Object(v.jsx)(Fe,{to:"/",children:"Blog"}),Object(v.jsxs)(Le,{className:"navbar-fixed-top",children:[Object(v.jsx)(Ne,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),i&&Object(v.jsx)(Ne,{to:"/new-post",$active:"/new-post"===t.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),!e&&Object(v.jsxs)(Le,{className:"navbar-fixed-top",children:[!i&&Object(v.jsx)(Ne,{to:"/register",$active:"/register"===t.pathname,children:"\u8a3b\u518a"}),!i&&Object(v.jsx)(Ne,{to:"/login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),i&&Object(v.jsx)(Ne,{to:"/login",onClick:function(){p(""),a(null),n("/")},children:"\u767b\u51fa"})]})]}),Object(v.jsx)(_e,{children:Object(v.jsx)("div",{className:"top-banner",children:Object(v.jsx)("div",{className:"top-banner__info",children:Object(v.jsx)("h1",{className:"top-banner__sub-title",children:"WELCOME TO MY BLOG"})})})})]})}var Be=j.b.div(Ce||(Ce=Object(b.a)(["\n  padding-top: 64px;\n"])));var Te=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(!0),a=Object(s.a)(i,2),o=a[0],b=a[1];return Object(r.useEffect)((function(){x()?f().then((function(e){b(!1),e.ok&&(c(e.data),b(!1))})):b(!1)}),[]),Object(v.jsx)(g.Provider,{value:{user:n,setUser:c},children:Object(v.jsx)(m.Provider,{value:{isLoading:o,setIsLoading:b},children:Object(v.jsx)(Be,{children:Object(v.jsxs)(d.a,{children:[Object(v.jsx)(Pe,{}),Object(v.jsxs)(u.c,{children:[Object(v.jsx)(u.a,{path:"/",element:Object(v.jsx)(X,{})}),Object(v.jsx)(u.a,{path:"/login",element:Object(v.jsx)(y,{})}),Object(v.jsx)(u.a,{path:"/register",element:Object(v.jsx)(ge,{})}),Object(v.jsx)(u.a,{path:"/posts/:id",element:Object(v.jsx)(je,{})}),Object(v.jsx)(u.a,{path:"/new-post",element:Object(v.jsx)(he,{})})]})]})})})})};o.a.render(Object(v.jsx)(j.a,{theme:{colors:{primary_300:"#3333dd",primary_400:"#e33e3e",primary_500:"#af0505"}},children:Object(v.jsx)(Te,{})}),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.10a11733.chunk.js.map